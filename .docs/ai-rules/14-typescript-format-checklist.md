# TypeScript 格式检查清单

## 概述

本文档定义了 Node.js 全栈开发指南的内容格式检查清单，确保所有文档内容符合规范要求。**必须逐文件检查，不能使用简单的搜索替换。**

## 核心检查项

### 1. 代码语言标签

- [ ] **必须使用简写标签**：所有 TypeScript 代码块使用 `ts` 而非 `typescript`
- [ ] **禁止使用 JavaScript 标签**：所有代码示例必须是 TypeScript，不能使用 `js` 或 `javascript` 标签

**检查方法**：逐文件检查所有代码块，确认标签为 ` ```ts`

### 2. TypeScript 类型注解

- [ ] **所有函数参数必须有类型注解**：包括所有函数、方法、箭头函数、回调函数等的所有参数
- [ ] **所有变量必须有类型注解**：包括 `const`、`let`、`var` 声明的所有变量，除非类型可以明确推断
- [ ] **所有接口和类型定义必须完整**：不能省略任何类型定义
- [ ] **所有类属性必须有类型注解**：包括类的所有属性和方法参数
- [ ] **所有函数返回值类型**：如果函数有返回值，应明确标注返回类型

**检查方法**：逐代码块检查所有代码，确保：
1. 所有函数参数（无论函数类型）都有类型注解
2. 所有变量声明都有明确的类型注解或可以明确推断
3. 所有接口、类型、类的定义完整
4. 所有回调函数参数都有类型注解
5. 所有事件处理器参数都有类型注解
6. 所有中间件函数参数都有类型注解
7. 所有异步函数参数都有类型注解

### 3. 导入语句

- [ ] **必须导入类型**：代码中使用的所有类型、接口、类都必须从相应包导入
- [ ] **使用 node: 前缀**：所有 Node.js 内置模块必须使用 `node:` 前缀
- [ ] **ESM 语法**：必须使用 `import` 而非 `require`
- [ ] **导入完整性**：确保所有使用的类型、函数、类都已正确导入

**检查方法**：逐代码块检查所有导入语句和代码使用，确保：
1. 所有 Node.js 内置模块（http、fs、path、crypto、os、process、events、stream、buffer、url、querystring、util、child_process、cluster 等）都使用 `node:` 前缀
2. 所有使用的类型（如 `FastifyRequest`、`FastifyReply`、`Request`、`Response`、`NextFunction`、`Context` 等）都已从相应包导入
3. 所有使用的函数、类都已正确导入
4. 没有使用 `require()` 语法
5. 导入语句使用正确的 ESM 语法

### 4. Markdown 格式

- [ ] **标题前后空行**：所有标题前后必须各有一空行
- [ ] **代码块前后空行**：所有代码块前后必须各有一空行
- [ ] **表格对齐**：表格必须在源文件中按 `|` 对齐列宽
- [ ] **列表格式**：列表与上一段之间必须空行

**检查方法**：视觉检查 Markdown 源文件

### 5. 内容完整性

- [ ] **章节类型检查**：根据章节类型检查必需要素（参考 [内容结构标准](06-content-structure.md)）
- [ ] **代码示例完整**：所有代码示例必须完整、可运行
- [ ] **参数说明**：所有函数/方法必须有参数说明（见 [函数文档格式标准](07-function-documentation.md)）
- [ ] **返回值说明**：所有函数/方法必须有返回值说明（见 [函数文档格式标准](07-function-documentation.md)）

## 检查流程

### 步骤 1：代码语言标签

1. 打开每个 Markdown 文件
2. 查找所有代码块（以 ``` 开头）
3. 确认所有 TypeScript 代码块使用 `ts` 标签
4. 记录并修复问题

### 步骤 2：TypeScript 类型注解

1. 打开每个 Markdown 文件
2. 检查所有代码块中的函数定义
3. 检查所有函数参数是否有类型注解
4. 检查所有变量声明是否有类型注解
5. 记录并修复问题

### 步骤 3：导入语句

1. 打开每个 Markdown 文件
2. 检查所有代码块开头的导入语句
3. 确认 Node.js 内置模块使用 `node:` 前缀
4. 确认所有类型都已导入
5. 确认没有使用 `require()` 语法
6. 记录并修复问题

### 步骤 4：Markdown 格式

1. 检查所有标题前后是否有空行
2. 检查所有代码块前后是否有空行
3. 检查所有表格是否对齐
4. 记录并修复问题

### 步骤 5：内容完整性

1. 对照章节类型检查必需要素
2. 检查所有代码示例是否完整
3. 检查所有函数/方法是否有参数和返回值说明
4. 记录并修复问题

## 常见错误示例

### 错误 1：缺少类型注解

```ts
// ❌ 错误
fastify.get('/', async (request, reply) => {
  return { message: 'Hello World' };
});

// ✅ 正确
fastify.get('/', async (request: FastifyRequest, reply: FastifyReply) => {
  return { message: 'Hello World' };
});
```

### 错误 2：使用完整语言标签

```markdown
<!-- ❌ 错误 -->
```typescript
const app = express();
```

<!-- ✅ 正确 -->
```ts
const app = express();
```
```

### 错误 3：缺少 node: 前缀

```ts
// ❌ 错误
import { createServer } from 'http';

// ✅ 正确
import { createServer } from 'node:http';
```

### 错误 4：使用 require

```ts
// ❌ 错误
const express = require('express');

// ✅ 正确
import express from 'express';
```

## 检查执行要求

### 必须遵守的原则

1. **逐文件检查**：必须打开每个文件，逐行检查，不能使用简单的搜索替换
2. **上下文理解**：检查时要理解代码上下文，确保类型注解和导入语句正确
3. **完整记录**：对发现的问题进行完整记录，包括文件路径、行号、问题描述
4. **修复验证**：修复后必须再次检查，确保问题已解决且没有引入新问题
5. **不允许偷懒**：所有检查项都必须严格执行，不能跳过或简化

### 检查优先级

1. **高优先级**：类型注解缺失、导入语句错误
2. **中优先级**：代码语言标签错误、node: 前缀缺失
3. **低优先级**：Markdown 格式问题、内容完整性

---

**最后更新**：2025-12-22
**适用范围**：Node.js 全栈开发指南所有文档
