# 2.13.5 é™æ€æ–¹æ³•ä¸å±æ€?

## æ¦‚è¿°

é™æ€æˆå‘˜ï¼ˆstaticï¼‰å±äºç±»æœ¬èº«ï¼Œè€Œéå®ä¾‹ã€‚å¸¸ç”¨äºï¼šå·¥å…·å‡½æ•°ã€å·¥å‚æ–¹æ³•ã€è®¡æ•°å™¨ã€ç¼“å­˜ã€å¸¸é‡é…ç½®ã€‚ES2022 å¼•å…¥äº†å…¬å…?ç§æœ‰é™æ€å­—æ®µä¸é™æ€åˆå§‹åŒ–å—ï¼Œä¸ºç±»çº§é€»è¾‘æä¾›æ›´å¼ºèƒ½åŠ›ã€‚æœ¬èŠ‚è¦†ç›–è¯­æ³•ã€å‚æ•?è¿”å›å€¼ã€è®¿é—®è§„åˆ™ã€ç»§æ‰¿ã€å¸¸è§é™·é˜±ã€æœ€ä½³å®è·µã€?

## é™æ€æ–¹æ³?

### åŸºæœ¬è¯­æ³•

```js
class MathUtils {
  static add(a, b) { return a + b; }
  static subtract(a, b) { return a - b; }
}

console.log(MathUtils.add(5, 3));      // 8
console.log(MathUtils.subtract(5, 3)); // 2
```

- è®¿é—®æ–¹å¼ï¼š`ClassName.method()`ï¼›å®ä¾‹ä¸å¯ç›´æ¥è®¿é—®ã€?
- è°ƒç”¨æ—?`this` æŒ‡å‘ç±»æœ¬èº«ï¼ˆé™¤éè¢?`call` æ”¹å˜ï¼‰ã€?

### å‚æ•°ä¸è¿”å›å€¼è¯´æ˜ï¼ˆç¤ºä¾‹ï¼?

- è¯­æ³•ï¼š`static add(a: number, b: number): number`
- å‚æ•°ï¼?
  - `a` (number) å¿…å¡«ï¼ŒåŠ æ•?
  - `b` (number) å¿…å¡«ï¼Œè¢«åŠ æ•°
- è¿”å›å€¼ï¼š`number`ï¼Œä¸¤æ•°ä¹‹å’?

## é™æ€å±æ€§ï¼ˆå…¬å…±ï¼?

ES2022 å…è®¸åœ¨ç±»ä½“å†…ç›´æ¥å£°æ˜é™æ€å­—æ®µã€?

```js
class User {
  static count = 0;
  static defaultRole = 'user';

  constructor(name) {
    this.name = name;
    User.count++;
  }
}

console.log(User.count); // 0
new User('John');
console.log(User.count); // 1
```

## ç§æœ‰é™æ€å­—æ®µä¸æ–¹æ³•

ä½¿ç”¨ `#` å£°æ˜ç§æœ‰é™æ€æˆå‘˜ï¼Œä»…åœ¨ç±»å†…éƒ¨å¯è§ã€?

```js
class Config {
  static #secret = 'token';
  static #getSecret() { return this.#secret; }

  static expose(mask = true) {
    return mask ? '***' : this.#getSecret();
  }
}

console.log(Config.expose());   // ***
// Config.#secret; // SyntaxError: ç§æœ‰å­—æ®µä¸å¯è®¿é—®
```

## é™æ€å—ï¼ˆstatic initialization blockï¼?

ç”¨äºç±»çº§åˆå§‹åŒ–é€»è¾‘ï¼Œå¯è®¿é—®ç§æœ‰é™æ€å­—æ®µã€?

```js
class Logger {
  static #initialized = false;
  static level;

  static {
    this.level = process.env.LOG_LEVEL || 'info';
    this.#initialized = true;
  }
}
```

## ç»§æ‰¿ä¸­çš„é™æ€æˆå‘?

- é™æ€æˆå‘˜ä¼šè¢«å­ç±»ç»§æ‰¿ï¼Œå¯é€šè¿‡ `super` è®¿é—®çˆ¶ç±»é™æ€æ–¹æ³•ã€?
- `this` åœ¨é™æ€æ–¹æ³•ä¸­æŒ‡å‘å½“å‰ç±»ï¼ˆå­ç±»è°ƒç”¨æ—¶æŒ‡å‘å­ç±»ï¼‰ã€?

```js
class Base {
  static type = 'base';
  static getType() { return this.type; }
}

class Sub extends Base {
  static type = 'sub';
}

console.log(Sub.getType()); // 'sub'ï¼Œthis æŒ‡å‘ Sub
console.log(Base.getType()); // 'base'
```

## å¸¸è§ä½¿ç”¨æ¨¡å¼

### 1) å·¥å…·/çº¯å‡½æ•°é›†å?
```js
class DateUtils {
  static toISO(date = new Date()) { return date.toISOString(); }
  static addDays(date, days) {
    const d = new Date(date);
    d.setDate(d.getDate() + days);
    return d;
  }
}
```

### 2) å·¥å‚æ–¹æ³•
```js
class User {
  constructor(name, role) { this.name = name; this.role = role; }
  static createAdmin(name) { return new User(name, 'admin'); }
}

const admin = User.createAdmin('Alice');
```

### 3) å•ä¾‹/ç¼“å­˜
```js
class Db {
  static #instance = null;
  static getInstance() {
    if (!this.#instance) this.#instance = new Db();
    return this.#instance;
  }
}
```

### 4) è®¡æ•°å™?ç»Ÿè®¡
```js
class Counter {
  static total = 0;
  constructor() { Counter.total++; }
}
```

### 5) å¸¸é‡ä¸é…ç½?
```js
class HttpStatus {
  static OK = 200;
  static NOT_FOUND = 404;
}
```

## ä¸å®ä¾‹æˆå‘˜çš„åŒºåˆ«

| å¯¹æ¯”é¡?      | é™æ€æˆå‘˜ï¼ˆstaticï¼?     | å®ä¾‹æˆå‘˜ï¼ˆé staticï¼?    |
| :----------- | :---------------------- | :------------------------ |
| å½’å±         | ç±»æœ¬èº?                 | å®ä¾‹å¯¹è±¡                  |
| è®¿é—®æ–¹å¼     | `ClassName.member`      | `instance.member`         |
| å†…å­˜å ç”¨     | å…±äº«ä¸€ä»?              | æ¯ä¸ªå®ä¾‹ä¸€ä»?             |
| é€‚ç”¨åœºæ™¯     | å·¥å…·ã€å¸¸é‡ã€å·¥å‚ã€ç¼“å­? | ä¸å…·ä½“å®ä¾‹çŠ¶æ€ç›¸å…³çš„è¡Œä¸º  |

## this åœ¨é™æ€æ–¹æ³•ä¸­çš„æŒ‡å?

åœ¨é™æ€æ–¹æ³•å†…ï¼Œé»˜è®?`this` ä¸ºç±»æœ¬èº«ï¼?

```js
class Demo {
  static who() { return this.name; } // ç±»å
}
console.log(Demo.who()); // 'Demo'
```

å­ç±»è°ƒç”¨æ—?`this` æŒ‡å‘å­ç±»ï¼Œæœ‰åŠ©äºå¤ç”¨ï¼?
```js
class A {
  static hello() { return this.id; }
}
class B extends A {}
B.id = 'B';
console.log(B.hello()); // 'B'
```

## å¸¸è§é™·é˜±

- **ç”¨å®ä¾‹è®¿é—®é™æ€æˆå‘?*ï¼š`instance.method` ä¸å¯è®¿é—®é™æ€æ–¹æ³•ï¼›éœ€ç”¨ç±»åã€? 
- **é‡æ–°ç»‘å®š this**ï¼šç”¨ `call/apply` æ”¹å˜é™æ€æ–¹æ³?this å¯èƒ½é€ æˆæ··æ·†ï¼Œä¸æ¨èé™¤éæœ‰æ„ä¸ºä¹‹ã€? 
- **æ»¥ç”¨é™æ€å­˜çŠ¶æ€?*ï¼šåœ¨å‰ç«¯ä¼šå…±äº«è·¨é¡µé¢é€»è¾‘ï¼Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„æ¼æˆ–æµ‹è¯•æ±¡æŸ“ã€? 
- **ç§æœ‰é™æ€è®¿é—®é”™è¯?*ï¼š`Class.#field` åªèƒ½åœ¨ç±»å†…éƒ¨ï¼›å­ç±»ä¹Ÿæ— æ³•ç›´æ¥è®¿é—®çˆ¶ç±»ç§æœ‰é™æ€ã€? 
- **å¾ªç¯ä¾èµ–**ï¼šé™æ€åˆå§‹åŒ–å?å­—æ®µè‹¥ä¾èµ–å…¶å®ƒæœªåŠ è½½å®Œæˆçš„æ¨¡å—ï¼Œå¯èƒ½å‡ºç° undefinedã€? 

## æœ€ä½³å®è·?

1. å°†â€œä¸å®ä¾‹æ— å…³â€çš„å·¥å…·ã€å·¥å‚ã€å¸¸é‡æ”¾å…¥é™æ€æˆå‘˜ï¼Œé¿å…å ç”¨å®ä¾‹å†…å­˜ã€? 
2. éœ€è¦å¤ç”¨ä¸”å…è®¸å­ç±»è¦†å†™æ—¶ï¼Œé™æ€æ–¹æ³•å†…éƒ¨ä½¿ç”?`this` è€Œéç¡¬ç¼–ç ç±»åï¼Œæ–¹ä¾¿ç»§æ‰¿æ‰©å±•ã€? 
3. é¿å…åœ¨é™æ€æˆå‘˜ä¸­å­˜æ”¾å¯å˜å…¨å±€çŠ¶æ€ï¼›å¦‚éœ€ç¼“å­˜ï¼Œæä¾›æ¸…ç†æ–¹æ³•æˆ–ä½¿ç”¨å¼±å¼•ç”?ä¾èµ–æ³¨å…¥ã€? 
4. å¯¹å¤–æš´éœ²å¸¸é‡æ—¶ä½¿ç”¨å…¨å¤§å†™æˆ–è¯­ä¹‰æ¸…æ™°çš„å‘½åï¼Œé¿å…é­”æ³•æ•°å­—ã€? 
5. ä½¿ç”¨ç§æœ‰é™æ€å­—æ®µä¿æŠ¤æ•æ„Ÿæ•°æ®æˆ–å†…éƒ¨ç¼“å­˜ï¼Œå®ç°ç±»çº§å°è£…ã€? 
6. ç¼–å†™æµ‹è¯•æ—¶æ¸…ç†é™æ€å¯å˜æ•°æ®ï¼Œé˜²æ­¢æµ‹è¯•é—´æ±¡æŸ“ã€? 

## ç»ƒä¹ 

1. ç¼–å†™ä¸€ä¸ªé™æ€å·¥å…·ç±»ï¼Œå®ç°å­—ç¬¦ä¸²è£å‰ªã€å»é‡ã€å¤§å°å†™è½¬æ¢ã€? 
2. ä½¿ç”¨ç§æœ‰é™æ€å­—æ®µå®ç°å•ä¾‹æ¨¡å¼ï¼Œå¹¶æä¾?`reset` ç”¨äºæµ‹è¯•æ¸…ç†ã€? 
3. ä¸ºä¸€ä¸?`Shape` åŸºç±»æ·»åŠ  `fromJSON` é™æ€å·¥å‚ï¼Œè¿”å›ä¸åŒå­ç±»å®ä¾‹ã€? 
4. ç¼–å†™ä¸€ä¸?`RateLimiter` é™æ€ç±»ï¼Œç»´æŠ¤å…¨å±€é…é¢è®¡æ•°ï¼Œå¹¶æ¼”ç¤ºå¤šå®ä¾‹å…±äº«é™åˆ¶ã€? 
5. åœ¨ç»§æ‰¿å±‚æ¬¡ä¸­æ¼”ç¤ºé™æ€æ–¹æ³•ä½¿ç”?`this` ä»¥æ”¯æŒå¤šæ€ï¼ˆçˆ¶ç±»è¿”å› `this.type`ï¼Œå­ç±»è¦†å†™ï¼‰ã€? 

## å°ç»“

- é™æ€æˆå‘˜å±äºç±»æœ¬èº«ï¼Œé€‚åˆå·¥å…·ã€å¸¸é‡ã€å·¥å‚ã€å…±äº«ç¼“å­?ç»Ÿè®¡ã€? 
- ES2022 æ”¯æŒå…¬å…±/ç§æœ‰é™æ€å­—æ®µä¸é™æ€åˆå§‹åŒ–å—ï¼Œä¾¿äºç±»çº§å°è£…ã€? 
- ç»§æ‰¿æ—¶é™æ€æˆå‘˜ä¼šè¢«å­ç±»ç»§æ‰¿ï¼Œ`this` æŒ‡å‘å½“å‰ç±»ï¼Œå¯å®ç°ç±»çº§å¤šæ€ã€? 
- è°¨æ…å­˜æ”¾å¯å˜å…¨å±€çŠ¶æ€ï¼Œæ³¨æ„æµ‹è¯•éš”ç¦»ä¸å®‰å…¨æ€§ã€? 

å®Œæˆæœ¬ç« å­¦ä¹ åï¼Œç»§ç»­å­¦ä¹ ä¸‹ä¸€ç« ï¼šé”™è¯¯ä¸å¼‚å¸¸å¤„ç†ã€?
